<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.113.0"><meta name=generator content="Relearn 5.2.3+tip"><meta name=description content><title>Deploying Private ARO clusters with Custom Domains :: Managed OpenShift Black Belt - Unofficial Documentation</title><link href=https://mobb.ninja/docs/aro/custom-domain-private-cluster/index.xml rel=alternate type=application/rss+xml title="Managed OpenShift Black Belt - Unofficial Documentation"><link href=https://mobb.ninja/css/fontawesome-all.min.css?1694031855 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=https://mobb.ninja/css/fontawesome-all.min.css?1694031855 rel=stylesheet></noscript><link href=https://mobb.ninja/css/featherlight.min.css?1694031855 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=https://mobb.ninja/css/featherlight.min.css?1694031855 rel=stylesheet></noscript><link href=https://mobb.ninja/css/auto-complete.css?1694031855 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=https://mobb.ninja/css/auto-complete.css?1694031855 rel=stylesheet></noscript><link href=https://mobb.ninja/css/perfect-scrollbar.min.css?1694031855 rel=stylesheet><link href=https://mobb.ninja/css/nucleus.css?1694031855 rel=stylesheet><link href=https://mobb.ninja/css/fonts.css?1694031855 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=https://mobb.ninja/css/fonts.css?1694031855 rel=stylesheet></noscript><link href=https://mobb.ninja/css/theme.css?1694031855 rel=stylesheet><link href=https://mobb.ninja/css/theme-red.css?1694031855 rel=stylesheet id=variant-style><link href=https://mobb.ninja/css/ie.css?1694031855 rel=stylesheet><link href=https://mobb.ninja/css/variant.css?1694031855 rel=stylesheet><link href=https://mobb.ninja/css/print.css?1694031855 rel=stylesheet media=print><script src=https://mobb.ninja/js/variant.js?1694031855></script>
<script>var index_url="https://mobb.ninja/index.json",baseUriFull,root_url="https://mobb.ninja/",baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="Copy to clipboard",window.T_Copied_to_clipboard="Copied to clipboard!",window.T_Copy_link_to_clipboard="Copy link to clipboard",window.T_Link_copied_to_clipboard="Copied link to clipboard!",baseUriFull="https://mobb.ninja/",window.variants&&variants.init(["red"])</script><script src=https://mobb.ninja/js/jquery.min.js?1694031855 defer></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WM5QQ0P3P1"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-WM5QQ0P3P1",{anonymize_ip:!1})}</script></head><body class="mobile-support html disableInlineCopyToClipboard" data-url=https://mobb.ninja/docs/aro/custom-domain-private-cluster/><div id=body class=default-animation><div id=sidebar-overlay></div><div id=toc-overlay></div><nav id=topbar class=highlightable><div><div class=navigation><a class="nav nav-next" href=https://mobb.ninja/docs/aro/cross-tenant-encryption-keys/ title="ARO - Cross Tenant Provisioning (&#129106;)"><i class="fas fa-chevron-right fa-fw"></i></a></div><div class=navigation><a class="nav nav-prev" href=https://mobb.ninja/docs/aro/ title="Azure Red Hat OpenShift (&#129104;)"><i class="fas fa-chevron-left fa-fw"></i></a></div><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle title='Menu (CTRL+ALT+m)'><i class="fas fa-bars fa-fw"></i></a></span>
<span id=toc-menu title='Table of Contents (CTRL+ALT+t)'><i class="fas fa-list-alt fa-fw"></i></span><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="4"><a itemprop=item href=https://mobb.ninja/><span itemprop=name>Documentation from the MOBB</span></a> ></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3"><a itemprop=item href=https://mobb.ninja/docs/><span itemprop=name>Documentation from the MOBB</span></a> ></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="2"><a itemprop=item href=https://mobb.ninja/docs/aro/><span itemprop=name>Azure Red Hat OpenShift</span></a> ></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="1"><a itemprop=item href=https://mobb.ninja/docs/aro/custom-domain-private-cluster/ aria-disabled=true><span itemprop=name>Deploying Private ARO clusters with Custom Domains</span></a></li></ol></div><div class="default-animation progress"><div class=wrapper><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#1-aro-cluster-networking>1. ARO cluster networking</a><ul><li><a href=#11-variables-and-resource-group>1.1 Variables and Resource Group</a></li><li><a href=#12-aro-networking-prerequisites>1.2 ARO Networking prerequisites</a></li><li><a href=#13-creating-private-aro-clusters-with-custom-domain>1.3 Creating Private ARO Clusters with Custom Domain:</a></li><li><a href=#14-jumphost>1.4 Jumphost</a></li></ul></li><li><a href=#2-configure-dns-for-the-private-aro-cluster-ingress-router-and-api>2. Configure DNS for the Private ARO Cluster (Ingress Router and API)</a><ul><li><a href=#21-configure-dns-for-default-ingress-router>2.1 Configure DNS for default ingress router</a></li><li><a href=#22-configure-dns-for-api-server-endpoint>2.2 Configure DNS for API server endpoint</a></li></ul></li><li><a href=#3-generate-lets-encrypt-certificates-for-api-server-and-default-ingress-router>3. Generate Let&rsquo;s Encrypt Certificates for API Server and default Ingress Router</a><ul><li><a href=#31-generate-le-certs-for-default-ingress-router-appsconsole>3.1 Generate LE Certs for default Ingress Router (*.apps/console)</a></li><li><a href=#32-generate-le-certs-for-the-api>3.2 Generate LE Certs for the api</a></li><li><a href=#41-configure-the-ingress-router-with-custom-certificates>4.1 Configure the Ingress Router with custom certificates</a></li><li><a href=#42-configure-the-api-server-with-custom-certificates>4.2 Configure the API server with custom certificates</a></li></ul></li></ul></nav></div></div></div></nav><main id=body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><div id=head-tags><div class=tags><a class=tag-link href=https://mobb.ninja/tags/aro>ARO</a>
<a class=tag-link href=https://mobb.ninja/tags/dns>DNS</a></div></div><style>.alert{padding:15px;margin-bottom:20px;border:1px solid transparent;border-radius:4px}.alert-warning{background-color:#fcf8e3;border-color:#fbeed5;color:#c09853}</style><p class="alert alert-warning"><b>IMPORTANT NOTE</b>: This site is not official Red Hat documentation and is provided for informational purposes only. These guides may be experimental, proof of concept, or early adoption. Officially supported documentation is available at <a href=https://docs.openshift.com target=_blank>docs.openshift.com</a> and <a href=https://access.redhat.com target=_blank>access.redhat.com</a>.</p><article class=default><h1>Deploying Private ARO clusters with Custom Domains</h1><hr><p><b>Authors:</b>
Roberto Carratalá<br><b>Last Editor:</b>
Roberto Carratalá<br><b>Published Date:</b>
4 September 2023<br><b>Modified Date:</b> 5 September 2023</p><hr><h2 id=overview>Overview</h2><p>By default Azure Red Hat OpenShift uses self-signed certificates for all of the routes created on <code>*.apps.&lt;random>.&lt;location>.aroapp.io</code>.</p><p>Many companies also seek to leverage the capabilities of Azure Red Hat OpenShift (ARO) to deploy their applications while using their own custom domain.
By utilizing ARO&rsquo;s custom domain feature, companies can ensure hosting their applications under their own domain name.</p><p>If we choose to specify a custom domain, for example aro.myorg.com, the OpenShift console will be available at a URL such as <code>https://console-openshift-console.apps.aro.myorg.com</code>, instead of the built-in domain <code>https://console-openshift-console.apps.&lt;random>.&lt;location>.aroapp.io</code>.</p><p>Furthermore, if we choose Custom DNS, after connecting to the cluster, we will need to configure a custom certificate for our ARO ingress controller and custom certificate of our API server.</p><h2 id=prerequisites>Prerequisites</h2><ul><li><a href=https://certbot.eff.org/ target=_blank>Certbot</a></li><li><a href=https://learn.microsoft.com/en-us/cli/azure/install-azure-cli target=_blank>AZ CLI</a></li><li><a href=https://github.com/sshuttle/sshuttle#obtaining-sshuttle target=_blank>sshutle</a></li></ul><ol><li><p>Set the following environment variables:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>export AZR_PULL_SECRET<span style=color:#f92672>=</span>~/Downloads/pull-secret.txt
</span></span><span style=display:flex><span>export NETWORK_SUBNET<span style=color:#f92672>=</span>10.0.0.0/20
</span></span><span style=display:flex><span>export CONTROL_SUBNET<span style=color:#f92672>=</span>10.0.0.0/24
</span></span><span style=display:flex><span>export MACHINE_SUBNET<span style=color:#f92672>=</span>10.0.1.0/24
</span></span><span style=display:flex><span>export JUMPHOST_SUBNET<span style=color:#f92672>=</span>10.0.3.0/24
</span></span><span style=display:flex><span>export NAMESPACE<span style=color:#f92672>=</span>aro-custom-domain
</span></span><span style=display:flex><span>export AZR_CLUSTER<span style=color:#f92672>=</span>aro-$USER
</span></span><span style=display:flex><span>export AZR_RESOURCE_LOCATION<span style=color:#f92672>=</span>eastus
</span></span><span style=display:flex><span>export AZR_RESOURCE_GROUP<span style=color:#f92672>=</span>aro-$USER-rg
</span></span><span style=display:flex><span>export DOMAIN<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;aroplay.openshiftdemo.dev&#34;</span>
</span></span><span style=display:flex><span>export AZR_DNS_RESOURCE_GROUP<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;mobb-dns&#34;</span>
</span></span><span style=display:flex><span>export EMAIL<span style=color:#f92672>=</span>username.taken@gmail.com
</span></span></code></pre></div></li></ol><h2 id=1-aro-cluster-networking>1. ARO cluster networking</h2><p>Before deploying Azure Red Hat OpenShift (ARO), there are certain prerequisites that need to be fulfilled.</p><h3 id=11-variables-and-resource-group>1.1 Variables and Resource Group</h3><ol><li><p>Create an Azure resource group:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az group create                <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --name $AZR_RESOURCE_GROUP   <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --location $AZR_RESOURCE_LOCATION
</span></span></code></pre></div></li></ol><h3 id=12-aro-networking-prerequisites>1.2 ARO Networking prerequisites</h3><ol><li><p>Create virtual network:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az network vnet create                                    <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --address-prefixes $NETWORK_SUBNET                      <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --name <span style=color:#e6db74>&#34;</span>$AZR_CLUSTER<span style=color:#e6db74>-aro-vnet-</span>$AZR_RESOURCE_LOCATION<span style=color:#e6db74>&#34;</span>   <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --resource-group $AZR_RESOURCE_GROUP
</span></span></code></pre></div></li><li><p>Create control plane subnet:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az network vnet subnet create                                     <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --resource-group $AZR_RESOURCE_GROUP                            <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --vnet-name <span style=color:#e6db74>&#34;</span>$AZR_CLUSTER<span style=color:#e6db74>-aro-vnet-</span>$AZR_RESOURCE_LOCATION<span style=color:#e6db74>&#34;</span>      <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --name <span style=color:#e6db74>&#34;</span>$AZR_CLUSTER<span style=color:#e6db74>-aro-control-subnet-</span>$AZR_RESOURCE_LOCATION<span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --address-prefixes $CONTROL_SUBNET                              <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --service-endpoints Microsoft.ContainerRegistry
</span></span></code></pre></div></li><li><p>Create machine subnet:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az network vnet subnet create                                       <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --resource-group $AZR_RESOURCE_GROUP                              <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --vnet-name <span style=color:#e6db74>&#34;</span>$AZR_CLUSTER<span style=color:#e6db74>-aro-vnet-</span>$AZR_RESOURCE_LOCATION<span style=color:#e6db74>&#34;</span>        <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --name <span style=color:#e6db74>&#34;</span>$AZR_CLUSTER<span style=color:#e6db74>-aro-machine-subnet-</span>$AZR_RESOURCE_LOCATION<span style=color:#e6db74>&#34;</span>   <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --address-prefixes $MACHINE_SUBNET                                <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --service-endpoints Microsoft.ContainerRegistry
</span></span></code></pre></div></li><li><p><a href="https://learn.microsoft.com/en-us/azure/private-link/disable-private-endpoint-network-policy?tabs=network-policy-portal" target=_blank>Disable network policies</a>
for Private Link Service on the control plane subnet:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az network vnet subnet update                                       <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --name <span style=color:#e6db74>&#34;</span>$AZR_CLUSTER<span style=color:#e6db74>-aro-control-subnet-</span>$AZR_RESOURCE_LOCATION<span style=color:#e6db74>&#34;</span>   <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --resource-group $AZR_RESOURCE_GROUP                              <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --vnet-name <span style=color:#e6db74>&#34;</span>$AZR_CLUSTER<span style=color:#e6db74>-aro-vnet-</span>$AZR_RESOURCE_LOCATION<span style=color:#e6db74>&#34;</span>        <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --disable-private-link-service-network-policies true
</span></span></code></pre></div></li></ol><h3 id=13-creating-private-aro-clusters-with-custom-domain>1.3 Creating Private ARO Clusters with Custom Domain:</h3><ol><li><p>Create private ARO Cluster with Custom Domain:</p><blockquote><p>When the &ndash;domain flag with an FQDN (e.g. my.domain.com) is used to create your cluster you will need to configure DNS and a certificate authority for your API server and apps ingress. This will be done once we establish connectivity to the cluster.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az aro create <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--resource-group $AZR_RESOURCE_GROUP <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--name $AZR_CLUSTER <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--vnet <span style=color:#e6db74>&#34;</span>$AZR_CLUSTER<span style=color:#e6db74>-aro-vnet-</span>$AZR_RESOURCE_LOCATION<span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--master-subnet <span style=color:#e6db74>&#34;</span>$AZR_CLUSTER<span style=color:#e6db74>-aro-control-subnet-</span>$AZR_RESOURCE_LOCATION<span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--worker-subnet <span style=color:#e6db74>&#34;</span>$AZR_CLUSTER<span style=color:#e6db74>-aro-machine-subnet-</span>$AZR_RESOURCE_LOCATION<span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--apiserver-visibility Private <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--ingress-visibility Private <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--pull-secret @$AZR_PULL_SECRET <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--domain $DOMAIN
</span></span></code></pre></div></li></ol><h3 id=14-jumphost>1.4 Jumphost</h3><p>As the cluster operates within a private network, it is possible to create a Jump host during the cluster creation process. This Jump host serves as a secure gateway that allows authorized users to connect to the private cluster environment.</p><ol><li><p>Create Jumphost subnet:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az network vnet subnet create                                <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --resource-group $AZR_RESOURCE_GROUP                       <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --vnet-name <span style=color:#e6db74>&#34;</span>$AZR_CLUSTER<span style=color:#e6db74>-aro-vnet-</span>$AZR_RESOURCE_LOCATION<span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --name JumpSubnet                                          <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --address-prefixes $JUMPHOST_SUBNET                        <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --service-endpoints Microsoft.ContainerRegistry
</span></span></code></pre></div></li><li><p>Create a Jumphost:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az vm create --name jumphost                 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --resource-group $AZR_RESOURCE_GROUP     <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --ssh-key-values $HOME/.ssh/id_rsa.pub   <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --admin-username aro                     <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --image <span style=color:#e6db74>&#34;RedHat:RHEL:9_1:9.1.2022112113&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --subnet JumpSubnet                      <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --public-ip-address jumphost-ip          <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --public-ip-sku Standard                 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --vnet-name <span style=color:#e6db74>&#34;</span>$AZR_CLUSTER<span style=color:#e6db74>-aro-vnet-</span>$AZR_RESOURCE_LOCATION<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div></li><li><p>Save the jump host public IP address:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>JUMP_IP<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>az vm list-ip-addresses -g $AZR_RESOURCE_GROUP -n jumphost -o tsv <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --query <span style=color:#e6db74>&#39;[].virtualMachine.network.publicIpAddresses[0].ipAddress&#39;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>  echo $JUMP_IP
</span></span></code></pre></div></li><li><p>Use sshuttle to create a ssh vpn via the jump host as a daemon:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>sshuttle --dns -NHr <span style=color:#e6db74>&#34;aro@</span><span style=color:#e6db74>${</span>JUMP_IP<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>  10.0.0.0/8 --daemon
</span></span></code></pre></div></li></ol><h2 id=2-configure-dns-for-the-private-aro-cluster-ingress-router-and-api>2. Configure DNS for the Private ARO Cluster (Ingress Router and API)</h2><p>Properly configuring DNS for the default ingress router, API server endpoint, and associated routes such as the console and *.apps is of utmost importance.</p><p>These DNS configurations ensure easy access to the cluster&rsquo;s console, application routes, and APIs, facilitating smooth administration and interaction with the OpenShift/Kubernetes environment.</p><h3 id=21-configure-dns-for-default-ingress-router>2.1 Configure DNS for default ingress router</h3><p>We need to configure the DNS for the Default Ingress Router (*.apps), to be able to access to the ARO Console, among other things.</p><ol><li><p>Retrieve the Ingress IP for Azure DNS records:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>INGRESS_IP<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>az aro show -n $AZR_CLUSTER -g $AZR_RESOURCE_GROUP --query <span style=color:#e6db74>&#39;ingressProfiles[0].ip&#39;</span> -o tsv<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo $INGRESS_IP
</span></span></code></pre></div></li></ol><h4 id=211-appsconsole-public-zone-ingress-configuration>2.1.1 Apps/Console Public Zone Ingress Configuration</h4><ol><li><p>Create your Azure DNS zone for $DOMAIN:</p><blockquote><p>NOTE: Alternatively you can use an existing zone if it exists. You need to have configured your domain name registrar to point to this zone.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az network dns zone create -g $RESOURCEGROUP -n $DOMAIN
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>az network dns zone create --parent-name $DOMAIN -g $AZR_DNS_RESOURCE_GROUP -n $DOMAIN
</span></span></code></pre></div></li><li><p>Add a record type A pointing the &ldquo;*.apps.DOMAIN&rdquo; to the Ingress LB IP, that is the Azure LB that balances the ARO/OpenShift Routers (Haproxies):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az network dns record-set a add-record <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -g $AZR_DNS_RESOURCE_GROUP <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -z $DOMAIN <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -n <span style=color:#e6db74>&#39;*.apps&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -a $INGRESS_IP
</span></span></code></pre></div></li><li><p>Adjust default TTL from 1 hour (choose an appropriate value, here 5 mins is used):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az network dns record-set a update -g $AZR_DNS_RESOURCE_GROUP -z $DOMAIN -n <span style=color:#e6db74>&#39;*.apps&#39;</span> --set ttl<span style=color:#f92672>=</span><span style=color:#ae81ff>300</span>
</span></span></code></pre></div></li><li><p>Test the *.apps domain:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>dig +short test.apps.$DOMAIN
</span></span></code></pre></div></li></ol><h3 id=22-configure-dns-for-api-server-endpoint>2.2 Configure DNS for API server endpoint</h3><p>We need to configure the DNS for the Kubernetes / OpenShift API of the ARO cluster, to be able to access to the ARO API.</p><ol><li><p>Retrieve the API Server IP for Azure DNS records:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>API_SERVER_IP<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>az aro show -n $AZR_CLUSTER -g $AZR_RESOURCE_GROUP --query <span style=color:#e6db74>&#39;apiserverProfile.ip&#39;</span> -o tsv<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>echo $API_SERVER_IP
</span></span></code></pre></div></li><li><p>Create an <code>api</code> A record to point to the Ingress Load Balancer IP:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az network dns record-set a add-record <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -g $AZR_DNS_RESOURCE_GROUP <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -z $DOMAIN <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -n <span style=color:#e6db74>&#39;api&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -a $API_SERVER_IP
</span></span></code></pre></div></li><li><p>Optional (good for initial testing): Adjust default TTL from 1 hour (choose an appropriate value, here 5 mins is used):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>az network dns record-set a update \
</span></span><span style=display:flex><span>  -g $AZR_DNS_RESOURCE_GROUP \
</span></span><span style=display:flex><span>  -z $DOMAIN \
</span></span><span style=display:flex><span>  -n &#39;api&#39; \
</span></span><span style=display:flex><span>  --set ttl=300
</span></span></code></pre></div></li><li><p>Test the api domain:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>dig +short api.$DOMAIN
</span></span></code></pre></div></li></ol><h2 id=3-generate-lets-encrypt-certificates-for-api-server-and-default-ingress-router>3. Generate Let&rsquo;s Encrypt Certificates for API Server and default Ingress Router</h2><p>The following example employs manually created Let&rsquo;s Encrypt certificates. However, it&rsquo;s important to note that this is not recommended for production environments unless an automated process has been established for the generation and renewal of these certificates (for instance, through the use of the Cert-Manager operator).</p><p>Keep in mind that these certificates are subject to expiry after 90 days.</p><blockquote><p>NOTE: this method relies on public DNS for the issuance of certificates since it uses a DNS challenge. Once the certificates have been issued, if desired, the public records can be removed (this could be the case if you&rsquo;ve created a private ARO cluster and plan to use Azure DNS private record sets).</p></blockquote><h3 id=31-generate-le-certs-for-default-ingress-router-appsconsole>3.1 Generate LE Certs for default Ingress Router (*.apps/console)</h3><ol><li><p>Create TLS Key Pair for the apps/console domain using certbot:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>export SCRATCH_DIR<span style=color:#f92672>=</span>/tmp/scratch
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>certbot certonly --manual <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --preferred-challenges<span style=color:#f92672>=</span>dns <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --email $EMAIL <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --server https://acme-v02.api.letsencrypt.org/directory <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --agree-tos <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --config-dir <span style=color:#e6db74>&#34;</span>$SCRATCH_DIR<span style=color:#e6db74>/config&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --work-dir <span style=color:#e6db74>&#34;</span>$SCRATCH_DIR<span style=color:#e6db74>/work&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --logs-dir <span style=color:#e6db74>&#34;</span>$SCRATCH_DIR<span style=color:#e6db74>/logs&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -d <span style=color:#e6db74>&#34;*.apps.</span>$DOMAIN<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div></li><li><p>Take note of the Domain and TXT value fields as these are required for Let&rsquo;s Encrypt to validate that you own the domain and can therefore issue you the certificates.</p><p>NOTE: don&rsquo;t close or interrupt this process, we will finish after the dns challenge with.</p></li><li><p>Open a second terminal and paste the DNS_Challenge <strong>(You will need to rexport the variables from the beginning in this new terminal)</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>export APPS_TXT_RECORD<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;xxxx&#34;</span>
</span></span></code></pre></div></li><li><p>You can add the necessary records to validate ownership of the apps domain:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az network dns record-set txt add-record <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -g $AZR_DNS_RESOURCE_GROUP <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -z $DOMAIN <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -n <span style=color:#e6db74>&#34;_acme-challenge.apps&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -v $APPS_TXT_RECORD
</span></span></code></pre></div></li><li><p>Update the TTL for the records from 1h to 5minutes to testing purposes:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az network dns record-set txt update <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -g $AZR_DNS_RESOURCE_GROUP <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -z $DOMAIN <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -n <span style=color:#e6db74>&#34;_acme-challenge.apps&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set ttl<span style=color:#f92672>=</span><span style=color:#ae81ff>300</span>
</span></span></code></pre></div></li><li><p>Make sure that you get the TXT record from the Azure domain challenge is registered and propagated properly:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>dig +short TXT _acme-challenge.apps.$DOMAIN
</span></span></code></pre></div></li><li><p>Return to the first terminal (where the certbot is), and finish the generation of the apps certificate PKIs for the ARO cluster.</p></li></ol><h3 id=32-generate-le-certs-for-the-api>3.2 Generate LE Certs for the api</h3><ol><li><p>Create TLS Key Pair for the api domain using certbot:</p><blockquote><p>NOTE: don&rsquo;t close or interrupt this process, we will finish after the dns challenge with the certbot.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>export SCRATCH_DIR<span style=color:#f92672>=</span>/tmp/scratch
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>certbot certonly --manual <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --preferred-challenges<span style=color:#f92672>=</span>dns <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --email $EMAIL <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --server https://acme-v02.api.letsencrypt.org/directory <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --agree-tos <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --config-dir <span style=color:#e6db74>&#34;</span>$SCRATCH_DIR<span style=color:#e6db74>/config&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --work-dir <span style=color:#e6db74>&#34;</span>$SCRATCH_DIR<span style=color:#e6db74>/work&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --logs-dir <span style=color:#e6db74>&#34;</span>$SCRATCH_DIR<span style=color:#e6db74>/logs&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -d <span style=color:#e6db74>&#34;api.</span>$DOMAIN<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div></li><li><p>Open the second terminal from earlier and paste the DNS_Challenge:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>export API_TXT_RECORD<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;xxxx&#34;</span>
</span></span></code></pre></div></li><li><p>You can add the necessary records to validate ownership of the api domain:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az network dns record-set txt add-record <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -g $AZR_DNS_RESOURCE_GROUP <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -z $DOMAIN <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -n <span style=color:#e6db74>&#34;_acme-challenge.api&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -v $API_TXT_RECORD
</span></span></code></pre></div></li><li><p>Adjust default TTL from 1 hour (choose an appropriate value, here 5 mins is used):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az network dns record-set txt update <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -g $AZR_DNS_RESOURCE_GROUP <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -z $DOMAIN <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -n <span style=color:#e6db74>&#34;_acme-challenge.api&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --set ttl<span style=color:#f92672>=</span><span style=color:#ae81ff>300</span>
</span></span></code></pre></div></li><li><p>Make sure that you get the TXT record from the Azure domain challenge is registered and propagated properly:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>dig +short TXT _acme-challenge.api.$DOMAIN
</span></span></code></pre></div></li><li><p>Return to the first terminal (where the certbot is), and finish the generation of the API certificate PKIs for the ARO cluster.</p></li></ol><h3 id=41-configure-the-ingress-router-with-custom-certificates>4.1 Configure the Ingress Router with custom certificates</h3><p>By default, the OpenShift Container Platform uses the Ingress Operator to generate an internal Certificate Authority (CA) and issue a wildcard certificate, which is valid for applications under the .apps sub-domain. This certificate is used by both the web console and CLI.</p><p>You can <a href=https://docs.openshift.com/container-platform/4.11/security/certificates/replacing-default-ingress-certificate.html target=_blank>replace the default ingress certificate</a>
for all applications under the .apps subdomain. After you replace the certificate, all applications, including the web console and CLI, will have encryption provided by specified certificate.</p><ol><li><p>Configure the API server with custom certificates:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>AROPASS<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>az aro list-credentials --name $AZR_CLUSTER --resource-group $AZR_RESOURCE_GROUP -o tsv --query kubeadminPassword<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>AROURL<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>az aro show -g $AZR_RESOURCE_GROUP -n $AZR_CLUSTER --query apiserverProfile.url -o tsv<span style=color:#66d9ef>)</span>
</span></span></code></pre></div></li><li><p>Login to the ARO cluster with oc CLI:</p><blockquote><p>Note: We are currently utilizing the &ldquo;&ndash;insecure-skip-tls-verify=true&rdquo; flag due to the presence of self-signed certificates in both the API and the default ingress controller (*.apps).</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>oc login -u kubeadmin -p $AROPASS --server<span style=color:#f92672>=</span>$AROURL --insecure-skip-tls-verify<span style=color:#f92672>=</span>true
</span></span></code></pre></div></li><li><p>Create a config map that includes only the root CA certificate used to sign the wildcard certificate:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>oc create configmap custom-ca <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --from-file<span style=color:#f92672>=</span>$SCRATCH_DIR/config/live/apps.$DOMAIN/fullchain.pem <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    -n openshift-config
</span></span></code></pre></div></li><li><p>Update the cluster-wide proxy configuration with the newly created config map:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>oc patch proxy/cluster <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --type<span style=color:#f92672>=</span>merge <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --patch<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;{&#34;spec&#34;:{&#34;trustedCA&#34;:{&#34;name&#34;:&#34;custom-ca&#34;}}}&#39;</span>
</span></span></code></pre></div></li><li><p>Create a secret that contains the wildcard certificate chain and key:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>oc create secret tls apps-custom-domain <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --cert<span style=color:#f92672>=</span>$SCRATCH_DIR/config/live/apps.$DOMAIN/fullchain.pem <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --key<span style=color:#f92672>=</span>$SCRATCH_DIR/config/live/apps.$DOMAIN/privkey.pem <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    -n openshift-ingress
</span></span></code></pre></div></li><li><p>Update the Ingress Controller configuration with the newly created secret:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>oc patch ingresscontroller.operator default <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--type<span style=color:#f92672>=</span>merge -p <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span><span style=color:#e6db74>&#39;{&#34;spec&#34;:{&#34;defaultCertificate&#34;:{&#34;name&#34;:&#34;apps-custom-domain&#34;}}}&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>-n openshift-ingress-operator
</span></span></code></pre></div></li><li><p>Check the OpenShift Ingress pods:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>oc get pod -n openshift-ingress
</span></span></code></pre></div></li><li><p>Verify that your certificate it&rsquo;s correctly applied:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>echo | openssl s_client -connect console-openshift-console.apps.$DOMAIN:443 | openssl x509 -noout -text | grep Issuer
</span></span></code></pre></div></li><li><p>Check that the Certificate when you access to the Console is the Cert issued by Let&rsquo;s Encrypt using Certbot:</p><p><img src=aro-custom-domain.png alt="ARO Custom Domain"></p></li></ol><h3 id=42-configure-the-api-server-with-custom-certificates>4.2 Configure the API server with custom certificates</h3><ol><li><p>Create a secret that contains the certificate chain and private key in the openshift-config namespace:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>oc create secret tls api-custom-domain-cert <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --cert<span style=color:#f92672>=</span>$SCRATCH_DIR/config/live/api.$DOMAIN/fullchain.pem <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --key<span style=color:#f92672>=</span>$SCRATCH_DIR/config/live/api.$DOMAIN/privkey.pem <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    -n openshift-config
</span></span></code></pre></div></li><li><p>Update the <a href=https://docs.openshift.com/container-platform/4.11/security/certificates/api-server.html target=_blank>API server certificate</a>
to reference the created secret. Patch the cluster&rsquo;s API server and <strong>replace <domain>with your customer domain</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>oc patch apiserver cluster <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--type<span style=color:#f92672>=</span>merge -p <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span><span style=color:#e6db74>&#39;{&#34;spec&#34;:{&#34;servingCerts&#34;:{&#34;namedCertificates&#34;:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>[{&#34;names&#34;:[&#34;api.&lt;DOMAIN&gt;&#34;],
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;servingCertificate&#34;:{&#34;name&#34;:&#34;api-custom-domain-cert&#34;}}]}}}&#39;</span>
</span></span></code></pre></div></li><li><p>Check the apiserver cluster CRD to check if the patch worked properly:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>oc get apiserver cluster -o yaml
</span></span></code></pre></div></li><li><p>After a couple of minutes, check the certificate exposed:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>echo | openssl s_client -connect api.$DOMAIN:6443 | openssl x509 -noout -text | grep Issuer
</span></span></code></pre></div></li><li><p>Logout and login without the &ldquo;&ndash;insecure-skip-tls-verify=true&rdquo;:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>oc logout
</span></span><span style=display:flex><span>oc login -u kubeadmin -p $AROPASS --server<span style=color:#f92672>=</span>$AROURL
</span></span></code></pre></div></li></ol><footer class=footline></footer></article></div></main></div><aside id=sidebar class=default-animation><div id=header-wrapper class=default-animation><div id=header class=default-animation><style>#logo svg,#logo svg *{color:#282828;color:var(--MENU-SECTIONS-BG-color);fill:#282828!important;fill:var(--MENU-SECTIONS-BG-color)!important;opacity:.945}a#logo{color:#282828;color:var(--MENU-SECTIONS-BG-color);font-family:work sans,helvetica,tahoma,geneva,arial,sans-serif;font-size:30px;font-weight:300;margin-top:-13px;max-width:80%;text-transform:uppercase;width:226px;white-space:nowrap}a#logo:hover{color:#282828;color:var(--MENU-SECTIONS-BG-color)}#logo svg{margin-bottom:-20px;margin-left:-23.5px;width:40.5%}@media only all and (max-width:59.938em){a#logo{font-size:25px;margin-top:-3px}#logo svg{margin-bottom:-12px;margin-left:-23px}}@media all and (-ms-high-contrast:none){a#logo{margin-top:-58px}#logo svg{margin-bottom:-62px}}</style><a id=logo href=https://mobb.ninja/><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M341.52 285.56c33.65.0 82.34-6.94 82.34-47 .22-6.74.86-1.82-20.88-96.24-4.62-19.15-8.68-27.84-42.31-44.65-26.09-13.34-82.92-35.37-99.73-35.37-15.66.0-20.2 20.17-38.87 20.17-18 0-31.31-15.06-48.12-15.06-16.14.0-26.66 11-34.78 33.62-27.5 77.55-26.28 74.27-26.12 78.27.0 24.8 97.64 106.11 228.47 106.11M429 254.84c4.65 22 4.65 24.35 4.65 27.25.0 37.66-42.33 58.56-98 58.56-125.74.08-235.91-73.65-235.91-122.33a49.55 49.55.0 014.06-19.72C58.56 200.86.0 208.93.0 260.63c0 84.67 200.63 189 359.49 189 121.79.0 152.51-55.08 152.51-98.58.0-34.21-29.59-73.05-82.93-96.24"/></svg>MOBB Ninja</a></div><div class="searchbox default-animation"><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script>var contentLangs=["en"]</script><script src=https://mobb.ninja/js/auto-complete.js?1694031855 defer></script>
<script src=https://mobb.ninja/js/lunr.min.js?1694031855 defer></script>
<script src=https://mobb.ninja/js/lunr.stemmer.support.min.js?1694031855 defer></script>
<script src=https://mobb.ninja/js/lunr.multi.min.js?1694031855 defer></script>
<script src=https://mobb.ninja/js/lunr.en.min.js?1694031855 defer></script>
<script src=https://mobb.ninja/js/search.js?1694031855 defer></script></div><div id=homelinks class=default-animation><ul><li><a class=padding href=https://mobb.ninja/><i class="fas fa-home"></i> Home</a></li></ul></div><div id=content-wrapper class=highlightable><ul class="topics collapsible-menu"><li data-nav-id=/docs/ title="Documentation from the MOBB" class="dd-item parent"><input type=checkbox id=section-2f67fdc9a362fd86f1cfd4450ed56551 class=toggle checked><label for=section-2f67fdc9a362fd86f1cfd4450ed56551></label><a href=https://mobb.ninja/docs/>Documentation from the MOBB</a><ul><li data-nav-id=/docs/quickstart-aro/ title="ARO Quickstart" class=dd-item><a href=https://mobb.ninja/docs/quickstart-aro/>ARO Quickstart</a></li><li data-nav-id=/docs/quickstart-rosa/ title="ROSA Quickstart" class=dd-item><a href=https://mobb.ninja/docs/quickstart-rosa/>ROSA Quickstart</a></li><li data-nav-id=/docs/rosa/ title="Red Hat Openshift Service on AWS" class=dd-item><input type=checkbox id=section-d82bea3b793597b6ff01917e2ad59aae class=toggle><label for=section-d82bea3b793597b6ff01917e2ad59aae></label><a href=https://mobb.ninja/docs/rosa/>Red Hat Openshift Service on AWS</a><ul><li data-nav-id=/docs/rosa/vpn/ title="Setup a VPN Connection into a Private Link ROSA Cluster with OpenVPN" class=dd-item><a href=https://mobb.ninja/docs/rosa/vpn/>Setup a VPN Connection into a Private Link ROSA Cluster with OpenVPN</a></li><li data-nav-id=/docs/rosa/prereq-list/ title="Prerequisites Checklist to Deploy ROSA Cluster with STS" class=dd-item><a href=https://mobb.ninja/docs/rosa/prereq-list/>Prerequisites Checklist to Deploy ROSA Cluster with STS</a></li><li data-nav-id=/docs/rosa/sts-rds/ title="Connect to RDS database with STS from ROSA" class=dd-item><a href=https://mobb.ninja/docs/rosa/sts-rds/>Connect to RDS database with STS from ROSA</a></li><li data-nav-id=/docs/rosa/ansible-rosa/ title="Deploying ROSA PrivateLink Cluster with Ansible" class=dd-item><a href=https://mobb.ninja/docs/rosa/ansible-rosa/>Deploying ROSA PrivateLink Cluster with Ansible</a></li><li data-nav-id=/docs/rosa/rosa-gitops/ title="Creating ROSA Components with GitOps" class=dd-item><a href=https://mobb.ninja/docs/rosa/rosa-gitops/>Creating ROSA Components with GitOps</a></li><li data-nav-id=/docs/rosa/aws-secrets-manager-csi/ title="Using AWS Secrets Manager CSI on Red Hat OpenShift on AWS with STS" class=dd-item><a href=https://mobb.ninja/docs/rosa/aws-secrets-manager-csi/>Using AWS Secrets Manager CSI on Red Hat OpenShift on AWS with STS</a></li><li data-nav-id=/docs/rosa/aws-efs/ title="Enabling the AWS EFS CSI Driver Operator on ROSA" class=dd-item><a href=https://mobb.ninja/docs/rosa/aws-efs/>Enabling the AWS EFS CSI Driver Operator on ROSA</a></li><li data-nav-id=/docs/rosa/egress-ip/ title="Assign Consistent Egress IP for External Traffic" class=dd-item><a href=https://mobb.ninja/docs/rosa/egress-ip/>Assign Consistent Egress IP for External Traffic</a></li><li data-nav-id=/docs/rosa/gpu/ title="ROSA with Nvidia GPU Workloads" class=dd-item><a href=https://mobb.ninja/docs/rosa/gpu/>ROSA with Nvidia GPU Workloads</a></li><li data-nav-id=/docs/rosa/external-dns/ title="External DNS for ROSA Custom Domain" class=dd-item><a href=https://mobb.ninja/docs/rosa/external-dns/>External DNS for ROSA Custom Domain</a></li><li data-nav-id=/docs/rosa/aws-load-balancer-operator/ title="AWS Load Balancer Operator On ROSA" class=dd-item><a href=https://mobb.ninja/docs/rosa/aws-load-balancer-operator/>AWS Load Balancer Operator On ROSA</a></li><li data-nav-id=/docs/rosa/clf-cloudwatch-vector/ title="Configuring the Cluster Log Forwarder for CloudWatch Logs using Vector" class=dd-item><a href=https://mobb.ninja/docs/rosa/clf-cloudwatch-vector/>Configuring the Cluster Log Forwarder for CloudWatch Logs using Vector</a></li><li data-nav-id=/docs/rosa/dynamic-certificates/ title="Dynamic Certificates for ROSA Custom Domain" class=dd-item><a href=https://mobb.ninja/docs/rosa/dynamic-certificates/>Dynamic Certificates for ROSA Custom Domain</a></li><li data-nav-id=/docs/rosa/verify-permissions/ title="Verify Permissions for ROSA STS Deployment" class=dd-item><a href=https://mobb.ninja/docs/rosa/verify-permissions/>Verify Permissions for ROSA STS Deployment</a></li><li data-nav-id=/docs/rosa/sts-oidc-flow/ title="STS OIDC in ROSA : How it works!" class=dd-item><a href=https://mobb.ninja/docs/rosa/sts-oidc-flow/>STS OIDC in ROSA : How it works!</a></li><li data-nav-id=/docs/rosa/security-ra/ title="Security Reference Architecture for ROSA" class=dd-item><a href=https://mobb.ninja/docs/rosa/security-ra/>Security Reference Architecture for ROSA</a></li><li data-nav-id=/docs/rosa/custom-alertmanager-4.9/ title="Custom AlertManager in ROSA 4.9.x" class=dd-item><a href=https://mobb.ninja/docs/rosa/custom-alertmanager-4.9/>Custom AlertManager in ROSA 4.9.x</a></li><li data-nav-id=/docs/rosa/clf-cloudwatch-sts/ title="Configuring the Cluster Log Forwarder for CloudWatch Logs and STS" class=dd-item><a href=https://mobb.ninja/docs/rosa/clf-cloudwatch-sts/>Configuring the Cluster Log Forwarder for CloudWatch Logs and STS</a></li><li data-nav-id=/docs/rosa/ack/ title="Using AWS Controllers for Kubernetes (ACK) on ROSA" class=dd-item><a href=https://mobb.ninja/docs/rosa/ack/>Using AWS Controllers for Kubernetes (ACK) on ROSA</a></li><li data-nav-id=/docs/rosa/ecr-secret-operator/ title="ECR Secret Operator" class=dd-item><input type=checkbox id=section-d622abc3689c39008edcc95bca0300b1 class=toggle><label for=section-d622abc3689c39008edcc95bca0300b1></label><a href=https://mobb.ninja/docs/rosa/ecr-secret-operator/>ECR Secret Operator</a><ul><li data-nav-id=/docs/rosa/ecr-secret-operator/iam_user/ title="Create IAM user and Policy" class=dd-item><a href=https://mobb.ninja/docs/rosa/ecr-secret-operator/iam_user/>Create IAM user and Policy</a></li><li data-nav-id=/docs/rosa/ecr-secret-operator/iam_assume_role/ title="Create STS Assume Role" class=dd-item><a href=https://mobb.ninja/docs/rosa/ecr-secret-operator/iam_assume_role/>Create STS Assume Role</a></li></ul></li><li data-nav-id=/docs/rosa/sts/ title="Deploying ROSA in STS mode" class=dd-item><a href=https://mobb.ninja/docs/rosa/sts/>Deploying ROSA in STS mode</a></li><li data-nav-id=/docs/rosa/ecr/ title="Configuring a ROSA cluster to pull images from AWS Elastic Container Registry (ECR)" class=dd-item><a href=https://mobb.ninja/docs/rosa/ecr/>Configuring a ROSA cluster to pull images from AWS Elastic Container Registry (ECR)</a></li><li data-nav-id=/docs/rosa/kms/ title="Creating a ROSA cluster in STS mode with custom KMS key" class=dd-item><a href=https://mobb.ninja/docs/rosa/kms/>Creating a ROSA cluster in STS mode with custom KMS key</a></li><li data-nav-id=/docs/rosa/cluster-metrics-to-aws-prometheus/ title="ROSA - Federating Metrics to AWS Prometheus" class=dd-item><a href=https://mobb.ninja/docs/rosa/cluster-metrics-to-aws-prometheus/>ROSA - Federating Metrics to AWS Prometheus</a></li><li data-nav-id=/docs/rosa/sts-cluster-logging-addon/ title="Work Around to fix the issue with the logging-addon on ROSA STS Clusters" class=dd-item><a href=https://mobb.ninja/docs/rosa/sts-cluster-logging-addon/>Work Around to fix the issue with the logging-addon on ROSA STS Clusters</a></li><li data-nav-id=/docs/rosa/federated-metrics-prometheus/ title="Federating Metrics to a centralized Prometheus Cluster" class=dd-item><a href=https://mobb.ninja/docs/rosa/federated-metrics-prometheus/>Federating Metrics to a centralized Prometheus Cluster</a></li><li data-nav-id=/docs/rosa/custom-alertmanager/ title="Custom Alerts in ROSA 4.11.x" class=dd-item><a href=https://mobb.ninja/docs/rosa/custom-alertmanager/>Custom Alerts in ROSA 4.11.x</a></li><li data-nav-id=/docs/rosa/using-sts-with-aws-services/ title="Extending ROSA STS to include authentication with AWS Services" class=dd-item><a href=https://mobb.ninja/docs/rosa/using-sts-with-aws-services/>Extending ROSA STS to include authentication with AWS Services</a></li><li data-nav-id=/docs/rosa/sts-and-pod-identity/ title="Integrating with AWS resources using Pod Identity" class=dd-item><a href=https://mobb.ninja/docs/rosa/sts-and-pod-identity/>Integrating with AWS resources using Pod Identity</a></li><li data-nav-id=/docs/rosa/metrics-to-cloudwatch-agent/ title="Using the AWS Cloud Watch agent to publish metrics to CloudWatch in ROSA" class=dd-item><a href=https://mobb.ninja/docs/rosa/metrics-to-cloudwatch-agent/>Using the AWS Cloud Watch agent to publish metrics to CloudWatch in ROSA</a></li><li data-nav-id=/docs/rosa/sts-with-private-link/ title="Creating a ROSA cluster with Private Link enabled (custom VPC) and STS" class=dd-item><a href=https://mobb.ninja/docs/rosa/sts-with-private-link/>Creating a ROSA cluster with Private Link enabled (custom VPC) and STS</a></li><li data-nav-id=/docs/rosa/waf/ title="Examples of using a WAF in front of ROSA / OSD on AWS / OCP on AWS" class=dd-item><input type=checkbox id=section-6293c009b4929ddbd0c9b2918068ea94 class=toggle><label for=section-6293c009b4929ddbd0c9b2918068ea94></label><a href=https://mobb.ninja/docs/rosa/waf/>Examples of using a WAF in front of ROSA / OSD on AWS / OCP on AWS</a><ul><li data-nav-id=/docs/rosa/waf/alb/ title="AWS ALB" class=dd-item><a href=https://mobb.ninja/docs/rosa/waf/alb/>AWS ALB</a></li><li data-nav-id=/docs/rosa/waf/readme-complex/ title="This is a POC of ROSA with a AWS WAF service" class=dd-item><a href=https://mobb.ninja/docs/rosa/waf/readme-complex/>This is a POC of ROSA with a AWS WAF service</a></li><li data-nav-id=/docs/rosa/waf/cloud-front/ title="Using CloudFront + WAF" class=dd-item><a href=https://mobb.ninja/docs/rosa/waf/cloud-front/>Using CloudFront + WAF</a></li></ul></li><li data-nav-id=/docs/rosa/byo-vpc/ title="Creating a Public/Private BYO VPC for ROSA" class=dd-item><a href=https://mobb.ninja/docs/rosa/byo-vpc/>Creating a Public/Private BYO VPC for ROSA</a></li><li data-nav-id=/docs/rosa/private-link/ title="Creating a ROSA cluster with Private Link enabled" class=dd-item><input type=checkbox id=section-71f53e8bae0a034c83f5c2f0c7c9c315 class=toggle><label for=section-71f53e8bae0a034c83f5c2f0c7c9c315></label><a href=https://mobb.ninja/docs/rosa/private-link/>Creating a ROSA cluster with Private Link enabled</a><ul><li data-nav-id=/docs/rosa/private-link/public-ingress/ title="Adding a Public Ingress endpoint to a ROSA Private-Link Cluster" class=dd-item><a href=https://mobb.ninja/docs/rosa/private-link/public-ingress/>Adding a Public Ingress endpoint to a ROSA Private-Link Cluster</a></li></ul></li><li data-nav-id=/docs/rosa/federated-metrics/ title="Federating System and User metrics to S3 in Red Hat OpenShift for AWS" class=dd-item><a href=https://mobb.ninja/docs/rosa/federated-metrics/>Federating System and User metrics to S3 in Red Hat OpenShift for AWS</a></li></ul></li><li data-nav-id=/docs/aro/ title="Azure Red Hat OpenShift" class="dd-item parent"><input type=checkbox id=section-ea9c20146e4edb7d3dc5cab0ddc4bd3a class=toggle checked><label for=section-ea9c20146e4edb7d3dc5cab0ddc4bd3a></label><a href=https://mobb.ninja/docs/aro/>Azure Red Hat OpenShift</a><ul><li data-nav-id=/docs/aro/custom-domain-private-cluster/ title="Deploying Private ARO clusters with Custom Domains" class="dd-item active"><a href=https://mobb.ninja/docs/aro/custom-domain-private-cluster/>Deploying Private ARO clusters with Custom Domains</a></li><li data-nav-id=/docs/aro/cross-tenant-encryption-keys/ title="ARO - Cross Tenant Provisioning" class=dd-item><a href=https://mobb.ninja/docs/aro/cross-tenant-encryption-keys/>ARO - Cross Tenant Provisioning</a></li><li data-nav-id=/docs/aro/blob-storage-csi/ title="Use Azure Blob storage Container Storage Interface (CSI) driver on an ARO cluster" class=dd-item><a href=https://mobb.ninja/docs/aro/blob-storage-csi/>Use Azure Blob storage Container Storage Interface (CSI) driver on an ARO cluster</a></li><li data-nav-id=/docs/aro/private_endpoint/ title="Configure a Private ARO cluster with Azure File via a Private Endpoint" class=dd-item><a href=https://mobb.ninja/docs/aro/private_endpoint/>Configure a Private ARO cluster with Azure File via a Private Endpoint</a></li><li data-nav-id=/docs/aro/aro-acr/ title="Using Azure Container Registry in Private ARO clusters" class=dd-item><a href=https://mobb.ninja/docs/aro/aro-acr/>Using Azure Container Registry in Private ARO clusters</a></li><li data-nav-id=/docs/aro/frontdoor/ title="Azure Front Door with ARO ( Azure Red Hat OpenShift )" class=dd-item><a href=https://mobb.ninja/docs/aro/frontdoor/>Azure Front Door with ARO ( Azure Red Hat OpenShift )</a></li><li data-nav-id=/docs/aro/vpn/ title="Setup a VPN Connection into an ARO Cluster with OpenVPN" class=dd-item><a href=https://mobb.ninja/docs/aro/vpn/>Setup a VPN Connection into an ARO Cluster with OpenVPN</a></li><li data-nav-id=/docs/aro/clf-to-azure/ title="Using Cluster Logging Forwarder in ARO with Azure Monitor" class=dd-item><a href=https://mobb.ninja/docs/aro/clf-to-azure/>Using Cluster Logging Forwarder in ARO with Azure Monitor</a></li><li data-nav-id=/docs/aro/upgrade-disconnected-aro/ title="Upgrade a disconnected ARO cluster" class=dd-item><a href=https://mobb.ninja/docs/aro/upgrade-disconnected-aro/>Upgrade a disconnected ARO cluster</a></li><li data-nav-id=/docs/aro/aro-machinesets/readme/ title="Helm Chart to set up extra MachineSets on ARO clusters" class=dd-item><a href=https://mobb.ninja/docs/aro/aro-machinesets/readme/>Helm Chart to set up extra MachineSets on ARO clusters</a></li><li data-nav-id=/docs/aro/azure-arc-integration/ title="Integrating Azure ARC with ARO" class=dd-item><a href=https://mobb.ninja/docs/aro/azure-arc-integration/>Integrating Azure ARC with ARO</a></li><li data-nav-id=/docs/aro/static-ip-load-balancer/ title="Configure a load balancer service to use a static public IP" class=dd-item><a href=https://mobb.ninja/docs/aro/static-ip-load-balancer/>Configure a load balancer service to use a static public IP</a></li><li data-nav-id=/docs/aro/shipping-logs-and-metrics-to-azure-blob/ title="Shipping logs and metrics to Azure Blob storage" class=dd-item><a href=https://mobb.ninja/docs/aro/shipping-logs-and-metrics-to-azure-blob/>Shipping logs and metrics to Azure Blob storage</a></li><li data-nav-id=/docs/aro/azure-service-operator/ title="Azure Service Operator" class=dd-item><input type=checkbox id=section-c4973928d95ad0b6b86b8742709cea9d class=toggle><label for=section-c4973928d95ad0b6b86b8742709cea9d></label><a href=https://mobb.ninja/docs/aro/azure-service-operator/>Azure Service Operator</a><ul><li data-nav-id=/docs/aro/azure-service-operator/v1/ title="Azure Service Operator V1 in ARO" class=dd-item><a href=https://mobb.ninja/docs/aro/azure-service-operator/v1/>Azure Service Operator V1 in ARO</a></li><li data-nav-id=/docs/aro/azure-service-operator/v2/ title="Azure Service Operator V2 in ARO" class=dd-item><a href=https://mobb.ninja/docs/aro/azure-service-operator/v2/>Azure Service Operator V2 in ARO</a></li></ul></li><li data-nav-id=/docs/aro/setup-quay/ title="Quay on ARO" class=dd-item><input type=checkbox id=section-107cd49f6d91378e87d08e36d5f67445 class=toggle><label for=section-107cd49f6d91378e87d08e36d5f67445></label><a href=https://mobb.ninja/docs/aro/setup-quay/>Quay on ARO</a><ul><li data-nav-id=/docs/aro/setup-quay/quay-console/ title="Setting up Quay on an ARO cluster via Console" class=dd-item><a href=https://mobb.ninja/docs/aro/setup-quay/quay-console/>Setting up Quay on an ARO cluster via Console</a></li><li data-nav-id=/docs/aro/setup-quay/quay-cli/ title="Setting up Quay on an ARO cluster via CLI" class=dd-item><a href=https://mobb.ninja/docs/aro/setup-quay/quay-cli/>Setting up Quay on an ARO cluster via CLI</a></li></ul></li><li data-nav-id=/docs/aro/add-infra-nodes/ title="Adding infrastructure nodes to an ARO cluster" class=dd-item><a href=https://mobb.ninja/docs/aro/add-infra-nodes/>Adding infrastructure nodes to an ARO cluster</a></li><li data-nav-id=/docs/aro/azure-policy/ title="Apply Azure Policy to Azure Policy" class=dd-item><a href=https://mobb.ninja/docs/aro/azure-policy/>Apply Azure Policy to Azure Policy</a></li><li data-nav-id=/docs/aro/registry/ title="Accessing the Internal Registry from ARO" class=dd-item><a href=https://mobb.ninja/docs/aro/registry/>Accessing the Internal Registry from ARO</a></li><li data-nav-id=/docs/aro/odf/ title="Configure ARO with OpenShift Data Foundation" class=dd-item><a href=https://mobb.ninja/docs/aro/odf/>Configure ARO with OpenShift Data Foundation</a></li><li data-nav-id=/docs/aro/gpu/ title="ARO with Nvidia GPU Workloads" class=dd-item><a href=https://mobb.ninja/docs/aro/gpu/>ARO with Nvidia GPU Workloads</a></li><li data-nav-id=/docs/aro/cert-manager/ title="ARO Custom domain with cert-manager and LetsEncrypt" class=dd-item><a href=https://mobb.ninja/docs/aro/cert-manager/>ARO Custom domain with cert-manager and LetsEncrypt</a></li><li data-nav-id=/docs/aro/ibm-cloud-paks-for-data/ title="ARO IBM Cloud Paks 4 Data" class=dd-item><a href=https://mobb.ninja/docs/aro/ibm-cloud-paks-for-data/>ARO IBM Cloud Paks 4 Data</a></li><li data-nav-id=/docs/aro/trident/ title="Trident NetApp operator setup for Azure NetApp files" class=dd-item><a href=https://mobb.ninja/docs/aro/trident/>Trident NetApp operator setup for Azure NetApp files</a></li><li data-nav-id=/docs/aro/managed-upgrade-operator/ title="Enable the Managed Upgrade Operator in ARO and schedule Upgrades" class=dd-item><a href=https://mobb.ninja/docs/aro/managed-upgrade-operator/>Enable the Managed Upgrade Operator in ARO and schedule Upgrades</a></li><li data-nav-id=/docs/aro/additional-ingress-controller/ title="Adding an additional ingress controller to an ARO cluster" class=dd-item><a href=https://mobb.ninja/docs/aro/additional-ingress-controller/>Adding an additional ingress controller to an ARO cluster</a></li><li data-nav-id=/docs/aro/ocm/ title="Registering an ARO cluster to OpenShift Cluster Manager" class=dd-item><a href=https://mobb.ninja/docs/aro/ocm/>Registering an ARO cluster to OpenShift Cluster Manager</a></li><li data-nav-id=/docs/aro/disaster-recovery/ title="ARO - Considerations for Disaster Recovery" class=dd-item><a href=https://mobb.ninja/docs/aro/disaster-recovery/>ARO - Considerations for Disaster Recovery</a></li><li data-nav-id=/docs/aro/private-cluster/ title="Private ARO Cluster with access via JumpHost" class=dd-item><a href=https://mobb.ninja/docs/aro/private-cluster/>Private ARO Cluster with access via JumpHost</a></li><li data-nav-id=/docs/aro/egress-ipam-operator/ title="Using the Egressip Ipam Operator with a Private ARO Cluster" class=dd-item><a href=https://mobb.ninja/docs/aro/egress-ipam-operator/>Using the Egressip Ipam Operator with a Private ARO Cluster</a></li><li data-nav-id=/docs/aro/user-workload-monitoring/ title="User Workload Monitoring on Azure Red Hat OpenShift" class=dd-item><a href=https://mobb.ninja/docs/aro/user-workload-monitoring/>User Workload Monitoring on Azure Red Hat OpenShift</a></li><li data-nav-id=/docs/aro/federated-metrics/ title="Federating System and User metrics to Azure Files in Azure Red Hat OpenShift" class=dd-item><a href=https://mobb.ninja/docs/aro/federated-metrics/>Federating System and User metrics to Azure Files in Azure Red Hat OpenShift</a></li><li data-nav-id=/docs/aro/astronomer/ title="Installing Astronomer on a private ARO cluster" class=dd-item><a href=https://mobb.ninja/docs/aro/astronomer/>Installing Astronomer on a private ARO cluster</a></li></ul></li><li data-nav-id=/docs/misc/ title=Miscellaneous class=dd-item><input type=checkbox id=section-4743293995ef089d075c101a4e477e5c class=toggle><label for=section-4743293995ef089d075c101a4e477e5c></label><a href=https://mobb.ninja/docs/misc/>Miscellaneous</a><ul><li data-nav-id=/docs/misc/token-refresher-proxy/ title="Patch token-refresher to use a cluster proxy" class=dd-item><a href=https://mobb.ninja/docs/misc/token-refresher-proxy/>Patch token-refresher to use a cluster proxy</a></li><li data-nav-id=/docs/misc/cost-management/ title="Red Hat Cost Management for Cloud Services" class=dd-item><a href=https://mobb.ninja/docs/misc/cost-management/>Red Hat Cost Management for Cloud Services</a></li><li data-nav-id=/docs/misc/azure-dev-ops-with-managed-openshift/ title="Azure DevOps with Managed OpenShift" class=dd-item><a href=https://mobb.ninja/docs/misc/azure-dev-ops-with-managed-openshift/>Azure DevOps with Managed OpenShift</a></li><li data-nav-id=/docs/misc/oadp/ title="MOBB Docs and Guides - oadp" class=dd-item><input type=checkbox id=section-325dd7bf30613094ac338d7da82aacea class=toggle><label for=section-325dd7bf30613094ac338d7da82aacea></label><a href=https://mobb.ninja/docs/misc/oadp/>MOBB Docs and Guides - oadp</a><ul><li data-nav-id=/docs/misc/oadp/aro/ title="Deploying OpenShift API for Data Protection on an ARO cluster" class=dd-item><a href=https://mobb.ninja/docs/misc/oadp/aro/>Deploying OpenShift API for Data Protection on an ARO cluster</a></li><li data-nav-id=/docs/misc/oadp/rosa-sts/ title="Deploying OpenShift API for Data Protection on a ROSA cluster" class=dd-item><a href=https://mobb.ninja/docs/misc/oadp/rosa-sts/>Deploying OpenShift API for Data Protection on a ROSA cluster</a></li></ul></li><li data-nav-id=/docs/misc/tls-cipher-customization/ title="Configure ROSA/OSD to use custom TLS ciphers on the ingress controllers" class=dd-item><a href=https://mobb.ninja/docs/misc/tls-cipher-customization/>Configure ROSA/OSD to use custom TLS ciphers on the ingress controllers</a></li><li data-nav-id=/docs/misc/jup/ title="Jupyter Notebooks" class=dd-item><input type=checkbox id=section-7af6414e26181825f2ee42d2fad956be class=toggle><label for=section-7af6414e26181825f2ee42d2fad956be></label><a href=https://mobb.ninja/docs/misc/jup/>Jupyter Notebooks</a><ul><li data-nav-id=/docs/misc/jup/buildnotebook/ title="How to deploy Jupyter Notebook" class=dd-item><a href=https://mobb.ninja/docs/misc/jup/buildnotebook/>How to deploy Jupyter Notebook</a></li><li data-nav-id=/docs/misc/jup/opendatahub-gpu/ title="Installing the Open Data Hub Operator" class=dd-item><a href=https://mobb.ninja/docs/misc/jup/opendatahub-gpu/>Installing the Open Data Hub Operator</a></li></ul></li><li data-nav-id=/docs/misc/default-router-custom-domain/ title="Stop default router from serving custom domain routes" class=dd-item><a href=https://mobb.ninja/docs/misc/default-router-custom-domain/>Stop default router from serving custom domain routes</a></li><li data-nav-id=/docs/misc/secrets-store-csi/ title="Installing the Kubernetes Secret Store CSI on OpenShift" class=dd-item><input type=checkbox id=section-83dcfc1bac9347003164dd6ca6bb9da6 class=toggle><label for=section-83dcfc1bac9347003164dd6ca6bb9da6></label><a href=https://mobb.ninja/docs/misc/secrets-store-csi/>Installing the Kubernetes Secret Store CSI on OpenShift</a><ul><li data-nav-id=/docs/misc/secrets-store-csi/hashicorp-vault/ title="Installing the HashiCorp Vault Secret CSI Driver" class=dd-item><a href=https://mobb.ninja/docs/misc/secrets-store-csi/hashicorp-vault/>Installing the HashiCorp Vault Secret CSI Driver</a></li><li data-nav-id=/docs/misc/secrets-store-csi/azure-key-vault/ title="Azure Key Vault CSI on Azure Red Hat OpenShift" class=dd-item><a href=https://mobb.ninja/docs/misc/secrets-store-csi/azure-key-vault/>Azure Key Vault CSI on Azure Red Hat OpenShift</a></li></ul></li><li data-nav-id=/docs/misc/common-images-namespace/ title="OpenShift - Sharing Common images" class=dd-item><a href=https://mobb.ninja/docs/misc/common-images-namespace/>OpenShift - Sharing Common images</a></li><li data-nav-id=/docs/misc/references/ title="Common Managed OpenShift References / Tasks" class=dd-item><a href=https://mobb.ninja/docs/misc/references/>Common Managed OpenShift References / Tasks</a></li></ul></li><li data-nav-id=/docs/o11y/ title=Observability class=dd-item><input type=checkbox id=section-cf64d50e30bf8c808e1a384a9dd9f94e class=toggle><label for=section-cf64d50e30bf8c808e1a384a9dd9f94e></label><a href=https://mobb.ninja/docs/o11y/>Observability</a><ul><li data-nav-id=/docs/o11y/openshift-logging/ title="OpenShift Logging" class=dd-item><a href=https://mobb.ninja/docs/o11y/openshift-logging/>OpenShift Logging</a></li><li data-nav-id=/docs/o11y/az-log-analytics/ title="Shipping logs to Azure Log Analytics" class=dd-item><a href=https://mobb.ninja/docs/o11y/az-log-analytics/>Shipping logs to Azure Log Analytics</a></li></ul></li><li data-nav-id=/docs/redhat/ title="Other Red Hat Products" class=dd-item><input type=checkbox id=section-61ee77d4a0d9667d2a6b99ce46059f1d class=toggle><label for=section-61ee77d4a0d9667d2a6b99ce46059f1d></label><a href=https://mobb.ninja/docs/redhat/>Other Red Hat Products</a><ul><li data-nav-id=/docs/redhat/rhacs/ title="Deploying Red Hat Advanced Cluster Security in ARO/ROSA" class=dd-item><a href=https://mobb.ninja/docs/redhat/rhacs/>Deploying Red Hat Advanced Cluster Security in ARO/ROSA</a></li><li data-nav-id=/docs/redhat/acm/ title="Advanced Cluster Management" class=dd-item><input type=checkbox id=section-d7942abe72cdf38022f3b7c824316905 class=toggle><label for=section-d7942abe72cdf38022f3b7c824316905></label><a href=https://mobb.ninja/docs/redhat/acm/>Advanced Cluster Management</a><ul><li data-nav-id=/docs/redhat/acm/submariner/ title="Advanced Cluster Management - Submariner" class=dd-item><input type=checkbox id=section-8144b1f974c3fa53914395fa7463b3ee class=toggle><label for=section-8144b1f974c3fa53914395fa7463b3ee></label><a href=https://mobb.ninja/docs/redhat/acm/submariner/>Advanced Cluster Management - Submariner</a><ul><li data-nav-id=/docs/redhat/acm/submariner/aro/ title="Deploy ACM Submariner for connect overlay networks ARO - ROSA clusters" class=dd-item><a href=https://mobb.ninja/docs/redhat/acm/submariner/aro/>Deploy ACM Submariner for connect overlay networks ARO - ROSA clusters</a></li><li data-nav-id=/docs/redhat/acm/submariner/rosa/ title="Deploy ACM Submariner for connect overlay networks of ROSA clusters" class=dd-item><a href=https://mobb.ninja/docs/redhat/acm/submariner/rosa/>Deploy ACM Submariner for connect overlay networks of ROSA clusters</a></li></ul></li><li data-nav-id=/docs/redhat/acm/observability/ title="Advanced Cluster Management - Observability" class=dd-item><input type=checkbox id=section-16c8cbcc1de529ce480045089e9bde5c class=toggle><label for=section-16c8cbcc1de529ce480045089e9bde5c></label><a href=https://mobb.ninja/docs/redhat/acm/observability/>Advanced Cluster Management - Observability</a><ul><li data-nav-id=/docs/redhat/acm/observability/rosa/ title="Advanced Cluster Management Observability on ROSA" class=dd-item><a href=https://mobb.ninja/docs/redhat/acm/observability/rosa/>Advanced Cluster Management Observability on ROSA</a></li></ul></li></ul></li><li data-nav-id=/docs/redhat/crane/ title="Migrate Kubernetes Applications with Konveyer Crane" class=dd-item><a href=https://mobb.ninja/docs/redhat/crane/>Migrate Kubernetes Applications with Konveyer Crane</a></li><li data-nav-id=/docs/redhat/3scale/ title="Deploying 3scale API Management to ROSA and OSD" class=dd-item><a href=https://mobb.ninja/docs/redhat/3scale/>Deploying 3scale API Management to ROSA and OSD</a></li><li data-nav-id=/docs/redhat/gitops/ title="Demonstrate GitOps on Managed OpenShift with ArgoCD" class=dd-item><a href=https://mobb.ninja/docs/redhat/gitops/>Demonstrate GitOps on Managed OpenShift with ArgoCD</a></li></ul></li><li data-nav-id=/docs/gcp/ title="OSD on Google Cloud" class=dd-item><input type=checkbox id=section-34c34dd71fe103bc20cfa9eed6fa905c class=toggle><label for=section-34c34dd71fe103bc20cfa9eed6fa905c></label><a href=https://mobb.ninja/docs/gcp/>OSD on Google Cloud</a><ul><li data-nav-id=/docs/gcp/osd_preexisting_vpc/ title="Creating a OSD in GCP with Existing VPCs" class=dd-item><a href=https://mobb.ninja/docs/gcp/osd_preexisting_vpc/>Creating a OSD in GCP with Existing VPCs</a></li><li data-nav-id=/docs/gcp/filestore/ title="Create Filestore Storage for OSD in GCP" class=dd-item><a href=https://mobb.ninja/docs/gcp/filestore/>Create Filestore Storage for OSD in GCP</a></li></ul></li><li data-nav-id=/docs/idp/ title="Configuring IDP for ROSA, OSD and ARO" class=dd-item><input type=checkbox id=section-de867ba7872b33ba38d343e5be5e3e1c class=toggle><label for=section-de867ba7872b33ba38d343e5be5e3e1c></label><a href=https://mobb.ninja/docs/idp/>Configuring IDP for ROSA, OSD and ARO</a><ul><li data-nav-id=/docs/idp/azuread-red-hat-sso/ title="Configure Red Hat SSO with Azure AD as a Federated Identity Provider" class=dd-item><a href=https://mobb.ninja/docs/idp/azuread-red-hat-sso/>Configure Red Hat SSO with Azure AD as a Federated Identity Provider</a></li><li data-nav-id=/docs/idp/considerations-aad-ipd/ title="What to consider when using Azure AD as IDP?" class=dd-item><a href=https://mobb.ninja/docs/idp/considerations-aad-ipd/>What to consider when using Azure AD as IDP?</a></li><li data-nav-id=/docs/idp/azuread-aro-cli/ title="Configure Azure AD as an OIDC identity provider for ARO with cli" class=dd-item><a href=https://mobb.ninja/docs/idp/azuread-aro-cli/>Configure Azure AD as an OIDC identity provider for ARO with cli</a></li><li data-nav-id=/docs/idp/azuread-aro/ title="Configure ARO to use Azure AD" class=dd-item><a href=https://mobb.ninja/docs/idp/azuread-aro/>Configure ARO to use Azure AD</a></li><li data-nav-id=/docs/idp/azuread/ title="Configure Azure AD as an OIDC identity provider for ROSA/OSD" class=dd-item><a href=https://mobb.ninja/docs/idp/azuread/>Configure Azure AD as an OIDC identity provider for ROSA/OSD</a></li><li data-nav-id=/docs/idp/group-claims/ title="MOBB Docs and Guides - group-claims" class=dd-item><input type=checkbox id=section-af199904c6a78739e6598ab72890c976 class=toggle><label for=section-af199904c6a78739e6598ab72890c976></label><a href=https://mobb.ninja/docs/idp/group-claims/>MOBB Docs and Guides - group-claims</a><ul><li data-nav-id=/docs/idp/group-claims/aro/ title="Configure ARO to use Azure AD Group Claims" class=dd-item><a href=https://mobb.ninja/docs/idp/group-claims/aro/>Configure ARO to use Azure AD Group Claims</a></li><li data-nav-id=/docs/idp/group-claims/rosa/ title="Configure ROSA to use Azure AD Group Claims" class=dd-item><a href=https://mobb.ninja/docs/idp/group-claims/rosa/>Configure ROSA to use Azure AD Group Claims</a></li></ul></li><li data-nav-id=/docs/idp/okta-grp-sync/ title="Using Group Sync Operator with Okta and ROSA/OSD" class=dd-item><a href=https://mobb.ninja/docs/idp/okta-grp-sync/>Using Group Sync Operator with Okta and ROSA/OSD</a></li><li data-nav-id=/docs/idp/gitlab-aro/ title="Configure GitLab as an identity provider for ARO" class=dd-item><a href=https://mobb.ninja/docs/idp/gitlab-aro/>Configure GitLab as an identity provider for ARO</a></li><li data-nav-id=/docs/idp/gitlab/ title="Configure GitLab as an identity provider for ROSA/OSD" class=dd-item><a href=https://mobb.ninja/docs/idp/gitlab/>Configure GitLab as an identity provider for ROSA/OSD</a></li><li data-nav-id=/docs/idp/az-ad-grp-sync/ title="Using Group Sync Operator with Azure Active Directory and ROSA" class=dd-item><a href=https://mobb.ninja/docs/idp/az-ad-grp-sync/>Using Group Sync Operator with Azure Active Directory and ROSA</a></li></ul></li></ul></li></ul><div id=shortcuts><div class=nav-title></div><ul><li><a class=padding href=https://github.com/rh-mobb/documentation target=_blank><i class='fab fa-fw fa-github'></i> Github</a></li><li><a class=padding href=https://github.com/rh-mobb/documentation/archive/refs/heads/main.zip target=_blank><i class='fas fa-fw fa-file-download'></i> Download</a></li><li><a class=padding href=https://www.redhat.com/en/blog target=_blank><i class='fab fa-fw fa-redhat'></i> Red Hat Blog</a></li><li><a class=padding href=https://www.redhat.com/en/contact target=_blank><i class='fas fa-fw fa-user-md'></i> Contact Us</a></li><li><a class=padding href=https://mobb.ninja/tags/ target=_blank><i class='fas fa-fw fa-tags'></i> Tags</a></li></ul></div><div class="footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter"></div><hr class="default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter"><div id=prefooter class="footerLangSwitch footerVariantSwitch footerVisitedLinks"><ul><li id=select-language-container class=footerLangSwitch><a class="padding select-container"><i class="fas fa-language fa-fw"></i>
<span>&nbsp;</span><div class=select-style><select id=select-language onchange="location=baseUri+this.value"></select></div><div class=select-clear></div></a></li><li id=select-variant-container class=footerVariantSwitch><a class="padding select-container"><i class="fas fa-paint-brush fa-fw"></i>
<span>&nbsp;</span><div class=select-style><select id=select-variant onchange=window.variants&&variants.changeVariant(this.value)><option id=red value=red selected>Red</option></select></div><div class=select-clear></div></a><script>window.variants&&variants.markSelectedVariant()</script></li><li class=footerVisitedLinks><a class=padding onclick=clearHistory()><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></div><div id=footer class="footerFooter showFooter"><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></aside><script src=https://mobb.ninja/js/clipboard.min.js?1694031855 defer></script>
<script src=https://mobb.ninja/js/perfect-scrollbar.min.js?1694031855 defer></script>
<script src=https://mobb.ninja/js/featherlight.min.js?1694031855 defer></script>
<script src=https://mobb.ninja/js/theme.js?1694031855 defer></script></body></html>